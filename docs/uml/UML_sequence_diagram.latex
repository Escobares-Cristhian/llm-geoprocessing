% generated by Plantuml 1.2024.3       
\definecolor{plantucolor0000}{RGB}{204,255,204}
\definecolor{plantucolor0001}{RGB}{24,24,24}
\definecolor{plantucolor0002}{RGB}{0,0,0}
\definecolor{plantucolor0003}{RGB}{221,221,221}
\definecolor{plantucolor0004}{RGB}{255,242,204}
\definecolor{plantucolor0005}{RGB}{255,204,204}
\definecolor{plantucolor0006}{RGB}{204,229,255}
\definecolor{plantucolor0007}{RGB}{171,211,255}
\definecolor{plantucolor0008}{RGB}{255,255,255}
\definecolor{plantucolor0009}{RGB}{226,226,240}
\definecolor{plantucolor0010}{RGB}{238,238,238}
\definecolor{plantucolor0011}{RGB}{254,255,221}
\begin{tikzpicture}[yscale=-1
,pstyle6/.style={color=plantucolor0001,line width=0.5pt,dash pattern=on 5.0pt off 5.0pt}
,pstyle7/.style={color=plantucolor0001,fill=white,line width=1.0pt}
,pstyle8/.style={color=plantucolor0001,fill=plantucolor0009,line width=0.5pt}
,pstyle9/.style={color=plantucolor0001,line width=0.5pt}
,pstyle10/.style={color=plantucolor0001,fill=plantucolor0001,line width=1.0pt}
,pstyle11/.style={color=plantucolor0001,fill=plantucolor0009,line width=1.5pt}
,pstyle12/.style={color=plantucolor0001,line width=1.5pt}
,pstyle13/.style={color=plantucolor0010,fill=plantucolor0010,line width=1.0pt}
,pstyle14/.style={color=black,line width=1.0pt}
,pstyle15/.style={color=black,fill=plantucolor0010,line width=2.0pt}
,pstyle16/.style={color=plantucolor0001,line width=1.0pt}
,pstyle17/.style={color=plantucolor0001,fill=plantucolor0011,line width=0.5pt}
,pstyle18/.style={color=black,fill=plantucolor0010,line width=1.5pt}
,pstyle19/.style={color=black,line width=1.5pt}
,pstyle20/.style={color=plantucolor0001,line width=1.0pt,dash pattern=on 2.0pt off 2.0pt}
]
\draw[color=plantucolor0001,fill=plantucolor0000,line width=0.5pt] (163.355pt,43.4473pt) rectangle (2348.507pt,3463.9844pt);
\node at (1182.7407pt,43.4473pt)[below right,color=black]{\textbf{geollm container}};
\draw[color=plantucolor0001,fill=plantucolor0003,line width=0.5pt] (2380.507pt,43.4473pt) rectangle (3093.6535pt,3463.9844pt);
\node at (2661.5418pt,43.4473pt)[below right,color=black]{\textbf{External Services}};
\draw[color=plantucolor0001,fill=plantucolor0004,line width=0.5pt] (2380.507pt,63.7197pt) rectangle (2605.6983pt,3463.9844pt);
\node at (2434.7204pt,63.7197pt)[below right,color=black]{\textbf{LLM Provider}};
\draw[color=plantucolor0001,fill=plantucolor0005,line width=0.5pt] (2637.6983pt,63.7197pt) rectangle (3093.6535pt,3463.9844pt);
\node at (2847.6565pt,63.7197pt)[below right,color=black]{\textbf{GEE}};
\draw[color=plantucolor0001,fill=plantucolor0006,line width=0.5pt] (3125.6535pt,43.4473pt) rectangle (3603.8682pt,3463.9844pt);
\node at (3285.4201pt,43.4473pt)[below right,color=black]{\textbf{Storage (optional)}};
\draw[color=plantucolor0001,fill=plantucolor0007,line width=0.5pt] (3125.6535pt,63.7197pt) rectangle (3419.2459pt,3463.9844pt);
\node at (3239.2322pt,63.7197pt)[below right,color=black]{\textbf{PostGIS}};
\node at (1691.0839pt,15pt)[below right,color=black]{\textbf{LLM Geoprocessing - Runtime Call Flow}};
\draw[pstyle6] (62pt,177.8828pt) -- (62pt,3457.9844pt);
\draw[pstyle7] (57pt,229.1553pt) rectangle (67pt,3457.9844pt);
\draw[pstyle6] (248.2735pt,177.8828pt) -- (248.2735pt,3457.9844pt);
\draw[pstyle7] (243.2735pt,525.3076pt) rectangle (253.2735pt,3457.9844pt);
\draw[pstyle6] (473.7638pt,177.8828pt) -- (473.7638pt,3457.9844pt);
\draw[pstyle7] (468.7638pt,554.5801pt) rectangle (478.7638pt,3457.9844pt);
\draw[pstyle6] (706.9268pt,177.8828pt) -- (706.9268pt,3457.9844pt);
\draw[pstyle7] (701.9268pt,295.6865pt) rectangle (711.9268pt,3457.9844pt);
\draw[pstyle7] (706.9268pt,848.0186pt) rectangle (716.9268pt,935.8359pt);
\draw[pstyle7] (706.9268pt,1011.374pt) rectangle (716.9268pt,1114.1846pt);
\draw[pstyle7] (706.9268pt,1658.0977pt) rectangle (716.9268pt,2157.5986pt);
\draw[pstyle7] (706.9268pt,3220.3633pt) rectangle (716.9268pt,3367.4395pt);
\draw[pstyle6] (1010.0896pt,177.8828pt) -- (1010.0896pt,3457.9844pt);
\draw[pstyle7] (1005.0896pt,686.6631pt) rectangle (1015.0896pt,1304.3936pt);
\draw[pstyle6] (1255.5873pt,177.8828pt) -- (1255.5873pt,3457.9844pt);
\draw[pstyle7] (1250.5873pt,1496.7422pt) rectangle (1260.5873pt,2824.0156pt);
\draw[pstyle6] (1487.6748pt,177.8828pt) -- (1487.6748pt,3457.9844pt);
\draw[pstyle7] (1482.6748pt,3013.7354pt) rectangle (1492.6748pt,3396.7119pt);
\draw[pstyle6] (1718.2042pt,177.8828pt) -- (1718.2042pt,3457.9844pt);
\draw[pstyle7] (1713.2042pt,2277.4023pt) rectangle (1723.2042pt,2468.8838pt);
\draw[pstyle6] (1961.5571pt,177.8828pt) -- (1961.5571pt,3457.9844pt);
\draw[pstyle7] (1956.5571pt,715.9355pt) rectangle (1966.5571pt,745.208pt);
\draw[pstyle7] (1956.5571pt,1526.0146pt) rectangle (1966.5571pt,1555.2871pt);
\draw[pstyle7] (1956.5571pt,3074.2803pt) rectangle (1966.5571pt,3103.5527pt);
\draw[pstyle6] (2219.8876pt,177.8828pt) -- (2219.8876pt,3457.9844pt);
\draw[pstyle7] (2214.8876pt,774.4805pt) rectangle (2224.8876pt,803.7529pt);
\draw[pstyle7] (2214.8876pt,1584.5596pt) rectangle (2224.8876pt,1613.832pt);
\draw[pstyle7] (2214.8876pt,3132.8252pt) rectangle (2224.8876pt,3162.0977pt);
\draw[pstyle6] (2493.1026pt,177.8828pt) -- (2493.1026pt,3457.9844pt);
\draw[pstyle7] (2488.1026pt,877.291pt) rectangle (2498.1026pt,906.5635pt);
\draw[pstyle7] (2488.1026pt,1055.6396pt) rectangle (2498.1026pt,1084.9121pt);
\draw[pstyle7] (2488.1026pt,1702.3633pt) rectangle (2498.1026pt,1731.6357pt);
\draw[pstyle7] (2488.1026pt,1953.5361pt) rectangle (2498.1026pt,1997.8018pt);
\draw[pstyle7] (2488.1026pt,3249.6357pt) rectangle (2498.1026pt,3293.9014pt);
\draw[pstyle6] (2776.4047pt,177.8828pt) -- (2776.4047pt,3457.9844pt);
\draw[pstyle7] (2771.4047pt,2336.8008pt) rectangle (2781.4047pt,2439.6113pt);
\draw[pstyle6] (3005.3823pt,177.8828pt) -- (3005.3823pt,3457.9844pt);
\draw[pstyle7] (3000.3823pt,2381.0664pt) rectangle (3010.3823pt,2410.3389pt);
\draw[pstyle6] (3202.9413pt,177.8828pt) -- (3202.9413pt,3457.9844pt);
\draw[pstyle7] (3197.9413pt,339.9521pt) rectangle (3207.9413pt,3457.9844pt);
\draw[pstyle6] (3350.7375pt,177.8828pt) -- (3350.7375pt,3457.9844pt);
\draw[pstyle7] (3345.7375pt,347.9521pt) rectangle (3355.7375pt,3457.9844pt);
\draw[pstyle6] (3527.557pt,177.8828pt) -- (3527.557pt,3457.9844pt);
\draw[pstyle7] (3522.557pt,2528.2822pt) rectangle (3532.557pt,3457.9844pt);
\node at (40.0118pt,161.5859pt)[below right,color=black]{User};
\draw[pstyle8] (62pt,110.0859pt) ellipse (8pt and 8pt);
\draw[pstyle9] (62pt,118.0859pt) -- (62pt,145.0859pt)(49pt,126.0859pt) -- (75pt,126.0859pt)(62pt,145.0859pt) -- (49pt,160.0859pt)(62pt,145.0859pt) -- (75pt,160.0859pt);
\node at (213.5826pt,145.2891pt)[below right,color=black]{Chat UI};
\node at (167.355pt,161.5859pt)[below right,color=black]{(cli.chat\_io.ChatIO)};
\draw[pstyle9] (227.7735pt,117.2891pt) -- (227.7735pt,141.2891pt)(227.7735pt,129.2891pt) -- (244.7735pt,129.2891pt);
\draw[pstyle8] (256.7735pt,129.2891pt) ellipse (12pt and 12pt);
\node at (428.1967pt,145.2891pt)[below right,color=black]{Main Loop};
\node at (427.8971pt,161.5859pt)[below right,color=black]{(app.main)};
\draw[pstyle8] (473.7638pt,129.2891pt) ellipse (12pt and 12pt);
\draw[pstyle10] (469.7638pt,117.2891pt) -- (475.7638pt,112.2891pt) -- (473.7638pt,117.2891pt) -- (475.7638pt,122.2891pt) -- (469.7638pt,117.2891pt) -- cycle;
\node at (671.832pt,145.2891pt)[below right,color=black]{Chatbot};
\node at (615.8816pt,161.5859pt)[below right,color=black]{(app.chatbot.Chatbot)};
\draw[pstyle8] (706.9268pt,129.2891pt) ellipse (12pt and 12pt);
\draw[pstyle10] (702.9268pt,117.2891pt) -- (708.9268pt,112.2891pt) -- (706.9268pt,117.2891pt) -- (708.9268pt,122.2891pt) -- (702.9268pt,117.2891pt) -- cycle;
\node at (924.3726pt,145.2891pt)[below right,color=black]{Mode Selector Agent};
\node at (885.7919pt,161.5859pt)[below right,color=black]{(app.llm.mode\_selector\_agent)};
\draw[pstyle8] (1010.0896pt,129.2891pt) ellipse (12pt and 12pt);
\draw[pstyle10] (1006.0896pt,117.2891pt) -- (1012.0896pt,112.2891pt) -- (1010.0896pt,117.2891pt) -- (1012.0896pt,122.2891pt) -- (1006.0896pt,117.2891pt) -- cycle;
\node at (1181.6786pt,145.2891pt)[below right,color=black]{Geoprocess Agent};
\node at (1144.3873pt,161.5859pt)[below right,color=black]{(app.llm.geoprocess\_agent)};
\draw[pstyle8] (1255.5873pt,129.2891pt) ellipse (12pt and 12pt);
\draw[pstyle10] (1251.5873pt,117.2891pt) -- (1257.5873pt,112.2891pt) -- (1255.5873pt,117.2891pt) -- (1257.5873pt,122.2891pt) -- (1251.5873pt,117.2891pt) -- cycle;
\node at (1415.0271pt,145.2891pt)[below right,color=black]{Interpreter Agent};
\node at (1376.7873pt,161.5859pt)[below right,color=black]{(app.llm.interpreter\_agent)};
\draw[pstyle8] (1487.6748pt,129.2891pt) ellipse (12pt and 12pt);
\draw[pstyle10] (1483.6748pt,117.2891pt) -- (1489.6748pt,112.2891pt) -- (1487.6748pt,117.2891pt) -- (1489.6748pt,122.2891pt) -- (1483.6748pt,117.2891pt) -- cycle;
\node at (1642.8429pt,145.2891pt)[below right,color=black]{Runtime Executor};
\node at (1608.5623pt,161.5859pt)[below right,color=black]{(plugins.runtime\_executor)};
\draw[pstyle8] (1718.2042pt,129.2891pt) ellipse (12pt and 12pt);
\draw[pstyle10] (1714.2042pt,117.2891pt) -- (1720.2042pt,112.2891pt) -- (1718.2042pt,117.2891pt) -- (1720.2042pt,122.2891pt) -- (1714.2042pt,117.2891pt) -- cycle;
\node at (1874.9571pt,145.2891pt)[below right,color=black]{Preprocessing Plugin};
\node at (1837.846pt,161.5859pt)[below right,color=black]{(plugins.preprocessing\_plugin)};
\draw[pstyle8] (1961.5571pt,129.2891pt) ellipse (12pt and 12pt);
\draw[pstyle10] (1957.5571pt,117.2891pt) -- (1963.5571pt,112.2891pt) -- (1961.5571pt,117.2891pt) -- (1963.5571pt,122.2891pt) -- (1957.5571pt,117.2891pt) -- cycle;
\node at (2131.3323pt,145.2891pt)[below right,color=black]{Geoprocessing Plugin};
\node at (2095.2683pt,161.5859pt)[below right,color=black]{(plugins.geoprocessing\_plugin)};
\draw[pstyle8] (2219.8876pt,129.2891pt) ellipse (12pt and 12pt);
\draw[pstyle10] (2215.8876pt,117.2891pt) -- (2221.8876pt,112.2891pt) -- (2219.8876pt,117.2891pt) -- (2221.8876pt,122.2891pt) -- (2215.8876pt,117.2891pt) -- cycle;
\node at (2434.2119pt,128.9922pt)[below right,color=black]{LLM Provider};
\node at (2384.507pt,145.2891pt)[below right,color=black]{[ChatGPT/Gemini/Ollama]};
\node at (2433.0373pt,161.5859pt)[below right,color=black]{(app.llm.LLM)};
\draw[pstyle8] (2493.1026pt,112.9922pt) ellipse (12pt and 12pt);
\draw[pstyle10] (2489.1026pt,100.9922pt) -- (2495.1026pt,95.9922pt) -- (2493.1026pt,100.9922pt) -- (2495.1026pt,105.9922pt) -- (2489.1026pt,100.9922pt) -- cycle;
\node at (2694.9811pt,145.2891pt)[below right,color=black]{GEE Plugin Service};
\node at (2641.6983pt,161.5859pt)[below right,color=black]{(app.plugins.gee.gee\_geoprocess)};
\draw[pstyle9] (2755.9047pt,117.2891pt) -- (2755.9047pt,141.2891pt)(2755.9047pt,129.2891pt) -- (2772.9047pt,129.2891pt);
\draw[pstyle8] (2784.9047pt,129.2891pt) ellipse (12pt and 12pt);
\node at (2932.4282pt,145.2891pt)[below right,color=black]{Earth Engine API};
\node at (2921.111pt,161.5859pt)[below right,color=black]{(earthengine-api: ee)};
\draw[pstyle8] (3005.3823pt,129.2891pt) ellipse (12pt and 12pt);
\draw[pstyle9] (2993.3823pt,143.2891pt) -- (3017.3823pt,143.2891pt);
\node at (3167.9231pt,128.9922pt)[below right,color=black]{ChatDB};
\node at (3129.6535pt,145.2891pt)[below right,color=black]{(PostGIS schema };
\node at (3136.5985pt,161.5859pt)[below right,color=black]{or Python class)};
\draw[pstyle11] (3184.9413pt,92.9922pt) ..controls (3184.9413pt,82.9922pt) and (3202.9413pt,82.9922pt) .. (3202.9413pt,82.9922pt) ..controls (3202.9413pt,82.9922pt) and (3220.9413pt,82.9922pt) .. (3220.9413pt,92.9922pt) -- (3220.9413pt,118.9922pt) ..controls (3220.9413pt,128.9922pt) and (3202.9413pt,128.9922pt) .. (3202.9413pt,128.9922pt) ..controls (3202.9413pt,128.9922pt) and (3184.9413pt,128.9922pt) .. (3184.9413pt,118.9922pt) -- (3184.9413pt,92.9922pt);
\draw[pstyle12] (3184.9413pt,92.9922pt) ..controls (3184.9413pt,102.9922pt) and (3202.9413pt,102.9922pt) .. (3202.9413pt,102.9922pt) ..controls (3202.9413pt,102.9922pt) and (3220.9413pt,102.9922pt) .. (3220.9413pt,92.9922pt);
\node at (3286.2291pt,145.2891pt)[below right,color=black]{PostGIS Raster};
\node at (3317.2634pt,161.5859pt)[below right,color=black]{uploads};
\draw[pstyle11] (3332.7375pt,109.2891pt) ..controls (3332.7375pt,99.2891pt) and (3350.7375pt,99.2891pt) .. (3350.7375pt,99.2891pt) ..controls (3350.7375pt,99.2891pt) and (3368.7375pt,99.2891pt) .. (3368.7375pt,109.2891pt) -- (3368.7375pt,135.2891pt) ..controls (3368.7375pt,145.2891pt) and (3350.7375pt,145.2891pt) .. (3350.7375pt,145.2891pt) ..controls (3350.7375pt,145.2891pt) and (3332.7375pt,145.2891pt) .. (3332.7375pt,135.2891pt) -- (3332.7375pt,109.2891pt);
\draw[pstyle12] (3332.7375pt,109.2891pt) ..controls (3332.7375pt,119.2891pt) and (3350.7375pt,119.2891pt) .. (3350.7375pt,119.2891pt) ..controls (3350.7375pt,119.2891pt) and (3368.7375pt,119.2891pt) .. (3368.7375pt,109.2891pt);
\node at (3457.7501pt,145.2891pt)[below right,color=black]{GeoTIFF Output};
\node at (3455.2459pt,161.5859pt)[below right,color=black]{(GEO\_OUT\_DIR)};
\draw[pstyle8] (3527.557pt,129.2891pt) ellipse (12pt and 12pt);
\draw[pstyle9] (3515.557pt,143.2891pt) -- (3539.557pt,143.2891pt);
\draw[pstyle13] (5pt,206.519pt) rectangle (3674.8682pt,209.519pt);
\draw[pstyle14] (5pt,206.519pt) -- (3674.8682pt,206.519pt);
\draw[pstyle14] (5pt,209.519pt) -- (3674.8682pt,209.519pt);
\draw[pstyle15] (1796.6579pt,195.8828pt) rectangle (1883.2103pt,219.1553pt);
\node at (1802.6579pt,199.8828pt)[below right,color=black]{\textbf{Startup }};
\draw[pstyle10] (689.9268pt,291.6865pt) -- (699.9268pt,295.6865pt) -- (689.9268pt,299.6865pt) -- (693.9268pt,295.6865pt) -- cycle;
\draw[pstyle16] (473.7638pt,295.6865pt) -- (695.9268pt,295.6865pt);
\node at (485.7638pt,255.7847pt)[below right,color=black]{\textbf{1}};
\node at (556.1085pt,233.1553pt)[below right,color=black]{initialize()};
\node at (499.6749pt,248.2881pt)[below right,color=black]{FactoryLLM.create\_llm()};
\node at (537.0026pt,263.4209pt)[below right,color=black]{ChatMemory};
\node at (635.3264pt,263.4209pt)[below right,color=black]{ };
\node at (640.1264pt,263.4209pt)[below right,color=black]{+};
\node at (536.006pt,278.5537pt)[below right,color=black]{ChatDB};
\node at (595.3291pt,278.5537pt)[below right,color=black]{ };
\node at (600.1291pt,278.5537pt)[below right,color=black]{session};
\draw[pstyle10] (3185.9413pt,335.9521pt) -- (3195.9413pt,339.9521pt) -- (3185.9413pt,343.9521pt) -- (3189.9413pt,339.9521pt) -- cycle;
\draw[pstyle16] (711.9268pt,339.9521pt) -- (3191.9413pt,339.9521pt);
\node at (1827.5578pt,315.1831pt)[below right,color=black]{\textbf{2}};
\node at (1841.4689pt,307.6865pt)[below right,color=black]{ensure\_schema()/create\_session};
\node at (1918.3078pt,322.8193pt)[below right,color=black]{(if};
\node at (1935.1078pt,322.8193pt)[below right,color=black]{ };
\node at (1939.9078pt,322.8193pt)[below right,color=black]{enabled)};
\draw[pstyle17] (478.7638pt,352.9521pt) -- (478.7638pt,392.9521pt) -- (1236.7638pt,392.9521pt) -- (1236.7638pt,362.9521pt) -- (1226.7638pt,352.9521pt) -- (478.7638pt,352.9521pt);
\draw[pstyle17] (1226.7638pt,352.9521pt) -- (1226.7638pt,362.9521pt) -- (1236.7638pt,362.9521pt) -- (1226.7638pt,352.9521pt);
\node at (484.7638pt,357.9521pt)[below right,color=black]{Typical launch:};
\node at (484.7638pt,373.085pt)[below right,color=black]{docker compose -f docker/compose.dev.yaml run geollm   python -m llm\_geoprocessing.app.main};
\draw[pstyle18] (8pt,402.2178pt) -- (89pt,402.2178pt) -- (89pt,409.4902pt) -- (79pt,419.4902pt) -- (8pt,419.4902pt) -- (8pt,402.2178pt);
\draw[pstyle19] (8pt,402.2178pt) rectangle (3665.8682pt,3433.9844pt);
\node at (23pt,403.2178pt)[below right,color=black]{\textbf{loop}};
\node at (104pt,404.2178pt)[below right,color=black]{\textbf{[until user closes session]}};
\draw[pstyle13] (5pt,450.1265pt) rectangle (3674.8682pt,453.1265pt);
\draw[pstyle14] (5pt,450.1265pt) -- (3674.8682pt,450.1265pt);
\draw[pstyle14] (5pt,453.1265pt) -- (3674.8682pt,453.1265pt);
\draw[pstyle15] (1730.0614pt,439.4902pt) rectangle (1949.8068pt,462.7627pt);
\node at (1736.0614pt,443.4902pt)[below right,color=black]{\textbf{Input + Mode Selection }};
\draw[pstyle18] (27pt,476.7627pt) -- (108pt,476.7627pt) -- (108pt,484.0352pt) -- (98pt,494.0352pt) -- (27pt,494.0352pt) -- (27pt,476.7627pt);
\draw[pstyle19] (27pt,476.7627pt) rectangle (3218.9413pt,1238.9951pt);
\node at (42pt,477.7627pt)[below right,color=black]{\textbf{loop}};
\node at (123pt,478.7627pt)[below right,color=black]{\textbf{[until selected mode is geoprocessing or interpreter]}};
\draw[pstyle10] (231.2735pt,521.3076pt) -- (241.2735pt,525.3076pt) -- (231.2735pt,529.3076pt) -- (235.2735pt,525.3076pt) -- cycle;
\draw[pstyle16] (67pt,525.3076pt) -- (237.2735pt,525.3076pt);
\node at (93.8775pt,508.0352pt)[below right,color=black]{\textbf{3}};
\node at (107.7886pt,508.105pt)[below right,color=black]{enter};
\node at (147.3886pt,508.105pt)[below right,color=black]{ };
\node at (152.1886pt,508.105pt)[below right,color=black]{message};
\draw[pstyle10] (456.7638pt,550.5801pt) -- (466.7638pt,554.5801pt) -- (456.7638pt,558.5801pt) -- (460.7638pt,554.5801pt) -- cycle;
\draw[pstyle16] (253.2735pt,554.5801pt) -- (462.7638pt,554.5801pt);
\node at (338.4631pt,537.3076pt)[below right,color=black]{\textbf{4}};
\node at (352.3742pt,537.3774pt)[below right,color=black]{msg};
\draw[pstyle10] (689.9268pt,579.8525pt) -- (699.9268pt,583.8525pt) -- (689.9268pt,587.8525pt) -- (693.9268pt,583.8525pt) -- cycle;
\draw[pstyle16] (478.7638pt,583.8525pt) -- (695.9268pt,583.8525pt);
\node at (498.345pt,566.5801pt)[below right,color=black]{\textbf{5}};
\node at (512.2561pt,566.6499pt)[below right,color=black]{check\_command(msg)};
\draw[pstyle10] (689.9268pt,609.125pt) -- (699.9268pt,613.125pt) -- (689.9268pt,617.125pt) -- (693.9268pt,613.125pt) -- cycle;
\draw[pstyle16] (478.7638pt,613.125pt) -- (695.9268pt,613.125pt);
\node at (506.5169pt,595.8525pt)[below right,color=black]{\textbf{6}};
\node at (520.428pt,595.9224pt)[below right,color=black]{mem.add\_user(msg)};
\draw[pstyle10] (3185.9413pt,653.3906pt) -- (3195.9413pt,657.3906pt) -- (3185.9413pt,661.3906pt) -- (3189.9413pt,657.3906pt) -- cycle;
\draw[pstyle16] (711.9268pt,657.3906pt) -- (3191.9413pt,657.3906pt);
\node at (1860.8716pt,632.6216pt)[below right,color=black]{\textbf{7}};
\node at (1874.7827pt,625.125pt)[below right,color=black]{insert\_message("user")};
\node at (1918.3078pt,640.2578pt)[below right,color=black]{(if};
\node at (1935.1078pt,640.2578pt)[below right,color=black]{ };
\node at (1939.9078pt,640.2578pt)[below right,color=black]{enabled)};
\draw[pstyle10] (993.0896pt,682.6631pt) -- (1003.0896pt,686.6631pt) -- (993.0896pt,690.6631pt) -- (997.0896pt,686.6631pt) -- cycle;
\draw[pstyle16] (478.7638pt,686.6631pt) -- (999.0896pt,686.6631pt);
\node at (619.8083pt,669.3906pt)[below right,color=black]{\textbf{8}};
\node at (633.7194pt,669.4604pt)[below right,color=black]{define\_mode\_interaction(msg)};
\draw[pstyle10] (1944.5571pt,711.9355pt) -- (1954.5571pt,715.9355pt) -- (1944.5571pt,719.9355pt) -- (1948.5571pt,715.9355pt) -- cycle;
\draw[pstyle16] (1015.0896pt,715.9355pt) -- (1950.5571pt,715.9355pt);
\node at (1352.1748pt,698.6631pt)[below right,color=black]{\textbf{9}};
\node at (1366.0859pt,698.7329pt)[below right,color=black]{get\_metadata/get\_documentation};
\draw[pstyle10] (1026.0896pt,741.208pt) -- (1016.0896pt,745.208pt) -- (1026.0896pt,749.208pt) -- (1022.0896pt,745.208pt) -- cycle;
\draw[pstyle20] (1020.0896pt,745.208pt) -- (1955.5571pt,745.208pt);
\node at (1418.7037pt,727.9355pt)[below right,color=black]{\textbf{10}};
\node at (1442.526pt,728.0054pt)[below right,color=black]{metadata/docs};
\draw[pstyle10] (2202.8876pt,770.4805pt) -- (2212.8876pt,774.4805pt) -- (2202.8876pt,778.4805pt) -- (2206.8876pt,774.4805pt) -- cycle;
\draw[pstyle16] (1015.0896pt,774.4805pt) -- (2208.8876pt,774.4805pt);
\node at (1476.3845pt,757.208pt)[below right,color=black]{\textbf{11}};
\node at (1500.2067pt,757.2778pt)[below right,color=black]{get\_metadata/get\_documentation};
\draw[pstyle10] (1026.0896pt,799.7529pt) -- (1016.0896pt,803.7529pt) -- (1026.0896pt,807.7529pt) -- (1022.0896pt,803.7529pt) -- cycle;
\draw[pstyle20] (1020.0896pt,803.7529pt) -- (2213.8876pt,803.7529pt);
\node at (1547.869pt,786.4805pt)[below right,color=black]{\textbf{12}};
\node at (1571.6912pt,786.5503pt)[below right,color=black]{metadata/docs};
\draw[pstyle10] (727.9268pt,844.0186pt) -- (717.9268pt,848.0186pt) -- (727.9268pt,852.0186pt) -- (723.9268pt,848.0186pt) -- cycle;
\draw[pstyle16] (721.9268pt,848.0186pt) -- (1004.0896pt,848.0186pt);
\node at (792.6425pt,823.2495pt)[below right,color=black]{\textbf{13}};
\node at (816.4647pt,815.7529pt)[below right,color=black]{clone()};
\node at (868.9011pt,815.7529pt)[below right,color=black]{ };
\node at (873.7011pt,815.7529pt)[below right,color=black]{+};
\node at (886.1738pt,815.7529pt)[below right,color=black]{ };
\node at (890.9738pt,815.7529pt)[below right,color=black]{build};
\node at (845.0172pt,830.8857pt)[below right,color=black]{prompt};
\draw[pstyle10] (2476.1026pt,873.291pt) -- (2486.1026pt,877.291pt) -- (2476.1026pt,881.291pt) -- (2480.1026pt,877.291pt) -- cycle;
\draw[pstyle16] (716.9268pt,877.291pt) -- (2482.1026pt,877.291pt);
\node at (1518.4528pt,860.0186pt)[below right,color=black]{\textbf{14}};
\node at (1542.275pt,860.0884pt)[below right,color=black]{chat\_once(prompt)};
\draw[pstyle10] (727.9268pt,902.5635pt) -- (717.9268pt,906.5635pt) -- (727.9268pt,910.5635pt) -- (723.9268pt,906.5635pt) -- cycle;
\draw[pstyle20] (721.9268pt,906.5635pt) -- (2487.1026pt,906.5635pt);
\node at (1536.8893pt,889.291pt)[below right,color=black]{\textbf{15}};
\node at (1560.7115pt,889.3608pt)[below right,color=black]{selected};
\node at (1621.9115pt,889.3608pt)[below right,color=black]{ };
\node at (1626.7115pt,889.3608pt)[below right,color=black]{mode};
\draw[pstyle10] (993.0896pt,931.8359pt) -- (1003.0896pt,935.8359pt) -- (993.0896pt,939.8359pt) -- (997.0896pt,935.8359pt) -- cycle;
\draw[pstyle20] (716.9268pt,935.8359pt) -- (999.0896pt,935.8359pt);
\node at (795.3828pt,918.5635pt)[below right,color=black]{\textbf{16}};
\node at (819.205pt,918.6333pt)[below right,color=black]{selected};
\node at (880.405pt,918.6333pt)[below right,color=black]{ };
\node at (885.205pt,918.6333pt)[below right,color=black]{mode};
\draw[pstyle18] (46pt,947.8359pt) -- (115.4381pt,947.8359pt) -- (115.4381pt,955.1084pt) -- (105.4381pt,965.1084pt) -- (46pt,965.1084pt) -- (46pt,947.8359pt);
\draw[pstyle19] (46pt,947.8359pt) rectangle (2617.6983pt,1224.9951pt);
\node at (61pt,948.8359pt)[below right,color=black]{\textbf{alt}};
\node at (130.4381pt,949.8359pt)[below right,color=black]{\textbf{[Capabilities query mode selected: "Consulta de Capacidades"]}};
\draw[pstyle10] (727.9268pt,1007.374pt) -- (717.9268pt,1011.374pt) -- (727.9268pt,1015.374pt) -- (723.9268pt,1011.374pt) -- cycle;
\draw[pstyle16] (721.9268pt,1011.374pt) -- (1004.0896pt,1011.374pt);
\node at (728.9268pt,986.605pt)[below right,color=black]{\textbf{17}};
\node at (752.749pt,979.1084pt)[below right,color=black]{clone().send\_message(summary};
\node at (841.9885pt,994.2412pt)[below right,color=black]{prompt)};
\draw[pstyle10] (2476.1026pt,1051.6396pt) -- (2486.1026pt,1055.6396pt) -- (2476.1026pt,1059.6396pt) -- (2480.1026pt,1055.6396pt) -- cycle;
\draw[pstyle16] (716.9268pt,1055.6396pt) -- (2482.1026pt,1055.6396pt);
\node at (1547.2419pt,1030.8706pt)[below right,color=black]{\textbf{18}};
\node at (1572.9972pt,1023.374pt)[below right,color=black]{summarize};
\node at (1571.0642pt,1038.5068pt)[below right,color=black]{capabilities};
\draw[pstyle10] (727.9268pt,1080.9121pt) -- (717.9268pt,1084.9121pt) -- (727.9268pt,1088.9121pt) -- (723.9268pt,1084.9121pt) -- cycle;
\draw[pstyle20] (721.9268pt,1084.9121pt) -- (2487.1026pt,1084.9121pt);
\node at (1555.5087pt,1067.6396pt)[below right,color=black]{\textbf{19}};
\node at (1579.3309pt,1067.7095pt)[below right,color=black]{summary};
\draw[pstyle10] (264.2735pt,1110.1846pt) -- (254.2735pt,1114.1846pt) -- (264.2735pt,1118.1846pt) -- (260.2735pt,1114.1846pt) -- cycle;
\draw[pstyle16] (258.2735pt,1114.1846pt) -- (700.9268pt,1114.1846pt);
\node at (349.4666pt,1096.9121pt)[below right,color=black]{\textbf{20}};
\node at (373.2888pt,1096.9819pt)[below right,color=black]{print\_assistant\_msg(summary)};
\draw[pstyle10] (78pt,1139.457pt) -- (68pt,1143.457pt) -- (78pt,1147.457pt) -- (74pt,1143.457pt) -- cycle;
\draw[pstyle20] (72pt,1143.457pt) -- (242.2735pt,1143.457pt);
\node at (79.6384pt,1126.1846pt)[below right,color=black]{\textbf{21}};
\node at (103.4606pt,1126.2544pt)[below right,color=black]{summary};
\node at (173.6505pt,1126.2544pt)[below right,color=black]{ };
\node at (178.4505pt,1126.2544pt)[below right,color=black]{to};
\node at (193.4351pt,1126.2544pt)[below right,color=black]{ };
\node at (198.2351pt,1126.2544pt)[below right,color=black]{user};
\draw[pstyle10] (489.7638pt,1183.7227pt) -- (479.7638pt,1187.7227pt) -- (489.7638pt,1191.7227pt) -- (485.7638pt,1187.7227pt) -- cycle;
\draw[pstyle20] (483.7638pt,1187.7227pt) -- (1004.0896pt,1187.7227pt);
\node at (676.7817pt,1162.9536pt)[below right,color=black]{\textbf{22}};
\node at (700.6039pt,1155.457pt)[below right,color=black]{"Wait};
\node at (742.6928pt,1155.457pt)[below right,color=black]{ };
\node at (747.4928pt,1155.457pt)[below right,color=black]{for};
\node at (769.8717pt,1155.457pt)[below right,color=black]{ };
\node at (774.6717pt,1155.457pt)[below right,color=black]{user};
\node at (730.4378pt,1170.5898pt)[below right,color=black]{input"};
\draw[pstyle10] (264.2735pt,1212.9951pt) -- (254.2735pt,1216.9951pt) -- (264.2735pt,1220.9951pt) -- (260.2735pt,1216.9951pt) -- cycle;
\draw[pstyle16] (258.2735pt,1216.9951pt) -- (467.7638pt,1216.9951pt);
\node at (286.1868pt,1199.7227pt)[below right,color=black]{\textbf{23}};
\node at (310.009pt,1199.7925pt)[below right,color=black]{ask\_user\_input()};
\draw[pstyle10] (489.7638pt,1300.3936pt) -- (479.7638pt,1304.3936pt) -- (489.7638pt,1308.3936pt) -- (485.7638pt,1304.3936pt) -- cycle;
\draw[pstyle20] (483.7638pt,1304.3936pt) -- (1004.0896pt,1304.3936pt);
\node at (662.4013pt,1272.0581pt)[below right,color=black]{\textbf{24}};
\node at (700.1235pt,1256.9951pt)[below right,color=black]{selected};
\node at (761.3235pt,1256.9951pt)[below right,color=black]{ };
\node at (766.1235pt,1256.9951pt)[below right,color=black]{mode};
\node at (686.2235pt,1272.1279pt)[below right,color=black]{(geoprocessing};
\node at (800.4235pt,1272.1279pt)[below right,color=black]{ };
\node at (805.2235pt,1272.1279pt)[below right,color=black]{or};
\node at (709.4378pt,1287.2607pt)[below right,color=black]{interpreter)};
\draw[pstyle10] (264.2735pt,1329.666pt) -- (254.2735pt,1333.666pt) -- (264.2735pt,1337.666pt) -- (260.2735pt,1333.666pt) -- cycle;
\draw[pstyle16] (258.2735pt,1333.666pt) -- (467.7638pt,1333.666pt);
\node at (265.2735pt,1316.3936pt)[below right,color=black]{\textbf{25}};
\node at (289.0957pt,1316.4634pt)[below right,color=black]{print\_mode\_selected()};
\draw[pstyle10] (78pt,1373.9316pt) -- (68pt,1377.9316pt) -- (78pt,1381.9316pt) -- (74pt,1377.9316pt) -- cycle;
\draw[pstyle20] (72pt,1377.9316pt) -- (242.2735pt,1377.9316pt);
\node at (90.9105pt,1353.1626pt)[below right,color=black]{\textbf{26}};
\node at (114.7327pt,1345.666pt)[below right,color=black]{show};
\node at (153.363pt,1345.666pt)[below right,color=black]{ };
\node at (158.163pt,1345.666pt)[below right,color=black]{selected};
\node at (146.3336pt,1360.7988pt)[below right,color=black]{mode};
\draw[pstyle13] (5pt,1406.5679pt) rectangle (3674.8682pt,1409.5679pt);
\draw[pstyle14] (5pt,1406.5679pt) -- (3674.8682pt,1406.5679pt);
\draw[pstyle14] (5pt,1409.5679pt) -- (3674.8682pt,1409.5679pt);
\draw[pstyle15] (1788.0328pt,1395.9316pt) rectangle (1891.8354pt,1419.2041pt);
\node at (1794.0328pt,1399.9316pt)[below right,color=black]{\textbf{Execution }};
\draw[pstyle18] (27pt,1433.2041pt) -- (96.4381pt,1433.2041pt) -- (96.4381pt,1440.4766pt) -- (86.4381pt,1450.4766pt) -- (27pt,1450.4766pt) -- (27pt,1433.2041pt);
\draw[pstyle19] (27pt,1433.2041pt) rectangle (3640.8682pt,2933.2041pt);
\node at (42pt,1434.2041pt)[below right,color=black]{\textbf{alt}};
\node at (111.4381pt,1435.2041pt)[below right,color=black]{\textbf{[Geoprocessing mode selected: "geoprocessing"]}};
\draw[color=black,line width=1.0pt,dash pattern=on 2.0pt off 2.0pt] (27pt,2878.1484pt) -- (3640.8682pt,2878.1484pt);
\node at (32pt,2880.1484pt)[below right,color=black]{\textbf{[Interpreter-only mode selected: "interpreter"]}};
\draw[pstyle10] (1238.5873pt,1492.7422pt) -- (1248.5873pt,1496.7422pt) -- (1238.5873pt,1500.7422pt) -- (1242.5873pt,1496.7422pt) -- cycle;
\draw[pstyle16] (478.7638pt,1496.7422pt) -- (1244.5873pt,1496.7422pt);
\node at (799.4978pt,1471.9731pt)[below right,color=black]{\textbf{27}};
\node at (823.32pt,1464.4766pt)[below right,color=black]{main(chatbot,};
\node at (825.6925pt,1479.6094pt)[below right,color=black]{chat\_io,};
\node at (885.4808pt,1479.6094pt)[below right,color=black]{ };
\node at (890.2808pt,1479.6094pt)[below right,color=black]{msg)};
\draw[pstyle10] (1944.5571pt,1522.0146pt) -- (1954.5571pt,1526.0146pt) -- (1944.5571pt,1530.0146pt) -- (1948.5571pt,1526.0146pt) -- cycle;
\draw[pstyle16] (1260.5873pt,1526.0146pt) -- (1950.5571pt,1526.0146pt);
\node at (1469.9681pt,1508.7422pt)[below right,color=black]{\textbf{28}};
\node at (1493.7903pt,1508.812pt)[below right,color=black]{get\_metadata/get\_documentation};
\draw[pstyle10] (1271.5873pt,1551.2871pt) -- (1261.5873pt,1555.2871pt) -- (1271.5873pt,1559.2871pt) -- (1267.5873pt,1555.2871pt) -- cycle;
\draw[pstyle20] (1265.5873pt,1555.2871pt) -- (1955.5571pt,1555.2871pt);
\node at (1541.4526pt,1538.0146pt)[below right,color=black]{\textbf{29}};
\node at (1565.2748pt,1538.0845pt)[below right,color=black]{metadata/docs};
\draw[pstyle10] (2202.8876pt,1580.5596pt) -- (2212.8876pt,1584.5596pt) -- (2202.8876pt,1588.5596pt) -- (2206.8876pt,1584.5596pt) -- cycle;
\draw[pstyle16] (1260.5873pt,1584.5596pt) -- (2208.8876pt,1584.5596pt);
\node at (1599.1333pt,1567.2871pt)[below right,color=black]{\textbf{30}};
\node at (1622.9555pt,1567.3569pt)[below right,color=black]{get\_metadata/get\_documentation};
\draw[pstyle10] (1271.5873pt,1609.832pt) -- (1261.5873pt,1613.832pt) -- (1271.5873pt,1617.832pt) -- (1267.5873pt,1613.832pt) -- cycle;
\draw[pstyle20] (1265.5873pt,1613.832pt) -- (2213.8876pt,1613.832pt);
\node at (1670.6178pt,1596.5596pt)[below right,color=black]{\textbf{31}};
\node at (1694.44pt,1596.6294pt)[below right,color=black]{metadata/docs};
\draw[pstyle10] (727.9268pt,1654.0977pt) -- (717.9268pt,1658.0977pt) -- (727.9268pt,1662.0977pt) -- (723.9268pt,1658.0977pt) -- cycle;
\draw[pstyle16] (721.9268pt,1658.0977pt) -- (1249.5873pt,1658.0977pt);
\node at (915.3914pt,1633.3286pt)[below right,color=black]{\textbf{32}};
\node at (939.2136pt,1625.832pt)[below right,color=black]{clone()};
\node at (991.6499pt,1625.832pt)[below right,color=black]{ };
\node at (996.4499pt,1625.832pt)[below right,color=black]{+};
\node at (1008.9227pt,1625.832pt)[below right,color=black]{ };
\node at (1013.7227pt,1625.832pt)[below right,color=black]{build};
\node at (945.7606pt,1640.9648pt)[below right,color=black]{JSON};
\node at (984.9714pt,1640.9648pt)[below right,color=black]{ };
\node at (989.7714pt,1640.9648pt)[below right,color=black]{prompt};
\draw[pstyle10] (2476.1026pt,1698.3633pt) -- (2486.1026pt,1702.3633pt) -- (2476.1026pt,1706.3633pt) -- (2480.1026pt,1702.3633pt) -- cycle;
\draw[pstyle16] (716.9268pt,1702.3633pt) -- (2482.1026pt,1702.3633pt);
\node at (1505.6427pt,1677.5942pt)[below right,color=black]{\textbf{33}};
\node at (1529.465pt,1670.0977pt)[below right,color=black]{send\_message(schema};
\node at (1583.495pt,1685.2305pt)[below right,color=black]{prompt)};
\draw[pstyle10] (727.9268pt,1727.6357pt) -- (717.9268pt,1731.6357pt) -- (727.9268pt,1735.6357pt) -- (723.9268pt,1731.6357pt) -- cycle;
\draw[pstyle20] (721.9268pt,1731.6357pt) -- (2487.1026pt,1731.6357pt);
\node at (1536.7167pt,1714.3633pt)[below right,color=black]{\textbf{34}};
\node at (1560.5389pt,1714.4331pt)[below right,color=black]{JSON};
\node at (1599.7497pt,1714.4331pt)[below right,color=black]{ };
\node at (1604.5497pt,1714.4331pt)[below right,color=black]{wrapper};
\draw[pstyle18] (46pt,1743.6357pt) -- (127pt,1743.6357pt) -- (127pt,1750.9082pt) -- (117pt,1760.9082pt) -- (46pt,1760.9082pt) -- (46pt,1743.6357pt);
\draw[pstyle19] (46pt,1743.6357pt) rectangle (2617.6983pt,2005.8018pt);
\node at (61pt,1744.6357pt)[below right,color=black]{\textbf{loop}};
\node at (142pt,1745.6357pt)[below right,color=black]{\textbf{[until complete or max turns]}};
\draw[pstyle10] (264.2735pt,1788.1807pt) -- (254.2735pt,1792.1807pt) -- (264.2735pt,1796.1807pt) -- (260.2735pt,1792.1807pt) -- cycle;
\draw[pstyle16] (258.2735pt,1792.1807pt) -- (1249.5873pt,1792.1807pt);
\node at (623.1391pt,1774.9082pt)[below right,color=black]{\textbf{35}};
\node at (646.9613pt,1774.978pt)[below right,color=black]{print\_assistant\_msg(questions)};
\draw[pstyle10] (78pt,1817.4531pt) -- (68pt,1821.4531pt) -- (78pt,1825.4531pt) -- (74pt,1821.4531pt) -- cycle;
\draw[pstyle20] (72pt,1821.4531pt) -- (242.2735pt,1821.4531pt);
\node at (79pt,1804.1807pt)[below right,color=black]{\textbf{36}};
\node at (102.8222pt,1804.2505pt)[below right,color=black]{questions};
\node at (174.2889pt,1804.2505pt)[below right,color=black]{ };
\node at (179.0889pt,1804.2505pt)[below right,color=black]{to};
\node at (194.0735pt,1804.2505pt)[below right,color=black]{ };
\node at (198.8735pt,1804.2505pt)[below right,color=black]{user};
\draw[pstyle10] (231.2735pt,1846.7256pt) -- (241.2735pt,1850.7256pt) -- (231.2735pt,1854.7256pt) -- (235.2735pt,1850.7256pt) -- cycle;
\draw[pstyle16] (67pt,1850.7256pt) -- (237.2735pt,1850.7256pt);
\node at (112.5641pt,1833.4531pt)[below right,color=black]{\textbf{37}};
\node at (136.3863pt,1833.5229pt)[below right,color=black]{answers};
\draw[pstyle10] (1238.5873pt,1875.998pt) -- (1248.5873pt,1879.998pt) -- (1238.5873pt,1883.998pt) -- (1242.5873pt,1879.998pt) -- cycle;
\draw[pstyle16] (253.2735pt,1879.998pt) -- (1244.5873pt,1879.998pt);
\node at (692.8443pt,1862.7256pt)[below right,color=black]{\textbf{38}};
\node at (716.6665pt,1862.7954pt)[below right,color=black]{user\_answer};
\draw[pstyle10] (727.9268pt,1905.2705pt) -- (717.9268pt,1909.2705pt) -- (727.9268pt,1913.2705pt) -- (723.9268pt,1909.2705pt) -- cycle;
\draw[pstyle16] (721.9268pt,1909.2705pt) -- (1249.5873pt,1909.2705pt);
\node at (883.466pt,1891.998pt)[below right,color=black]{\textbf{39}};
\node at (907.2883pt,1892.0679pt)[below right,color=black]{mem.add\_user(answer)};
\draw[pstyle10] (2476.1026pt,1949.5361pt) -- (2486.1026pt,1953.5361pt) -- (2476.1026pt,1957.5361pt) -- (2480.1026pt,1953.5361pt) -- cycle;
\draw[pstyle16] (716.9268pt,1953.5361pt) -- (2482.1026pt,1953.5361pt);
\node at (1508.0237pt,1928.7671pt)[below right,color=black]{\textbf{40}};
\node at (1531.846pt,1921.2705pt)[below right,color=black]{send\_message(update};
\node at (1583.495pt,1936.4033pt)[below right,color=black]{prompt)};
\draw[pstyle10] (727.9268pt,1993.8018pt) -- (717.9268pt,1997.8018pt) -- (727.9268pt,2001.8018pt) -- (723.9268pt,1997.8018pt) -- cycle;
\draw[pstyle20] (721.9268pt,1997.8018pt) -- (2487.1026pt,1997.8018pt);
\node at (1537.6674pt,1973.0327pt)[below right,color=black]{\textbf{41}};
\node at (1561.4896pt,1965.5361pt)[below right,color=black]{updated};
\node at (1623.3512pt,1965.5361pt)[below right,color=black]{ };
\node at (1628.1512pt,1965.5361pt)[below right,color=black]{JSON};
\node at (1582.5443pt,1980.6689pt)[below right,color=black]{wrapper};
\draw[pstyle16] (1260.5873pt,2056.0674pt) -- (1302.5873pt,2056.0674pt);
\draw[pstyle16] (1302.5873pt,2056.0674pt) -- (1302.5873pt,2069.0674pt);
\draw[pstyle16] (1261.5873pt,2069.0674pt) -- (1302.5873pt,2069.0674pt);
\draw[pstyle10] (1271.5873pt,2065.0674pt) -- (1261.5873pt,2069.0674pt) -- (1271.5873pt,2073.0674pt) -- (1267.5873pt,2069.0674pt) -- cycle;
\node at (1267.5873pt,2031.2983pt)[below right,color=black]{\textbf{42}};
\node at (1306.9199pt,2023.8018pt)[below right,color=black]{validate/fix};
\node at (1390.5987pt,2023.8018pt)[below right,color=black]{ };
\node at (1395.3987pt,2023.8018pt)[below right,color=black]{JSON};
\node at (1291.4095pt,2038.9346pt)[below right,color=black]{(check\_and\_fix\_json)};
\draw[pstyle10] (727.9268pt,2109.333pt) -- (717.9268pt,2113.333pt) -- (727.9268pt,2117.333pt) -- (723.9268pt,2113.333pt) -- cycle;
\draw[pstyle16] (721.9268pt,2113.333pt) -- (1249.5873pt,2113.333pt);
\node at (853.7359pt,2088.564pt)[below right,color=black]{\textbf{43}};
\node at (877.5581pt,2081.0674pt)[below right,color=black]{mem.add\_assistant("Generated};
\node at (959.8627pt,2096.2002pt)[below right,color=black]{JSON};
\node at (999.0735pt,2096.2002pt)[below right,color=black]{ };
\node at (1003.8735pt,2096.2002pt)[below right,color=black]{...")};
\draw[pstyle10] (3185.9413pt,2153.5986pt) -- (3195.9413pt,2157.5986pt) -- (3185.9413pt,2161.5986pt) -- (3189.9413pt,2157.5986pt) -- cycle;
\draw[pstyle16] (716.9268pt,2157.5986pt) -- (3191.9413pt,2157.5986pt);
\node at (1841.5286pt,2132.8296pt)[below right,color=black]{\textbf{44}};
\node at (1865.3509pt,2125.333pt)[below right,color=black]{insert\_message("assistant")};
\node at (1925.7633pt,2140.4658pt)[below right,color=black]{(if};
\node at (1942.5633pt,2140.4658pt)[below right,color=black]{ };
\node at (1947.3633pt,2140.4658pt)[below right,color=black]{enabled)};
\draw[pstyle10] (3185.9413pt,2197.8643pt) -- (3195.9413pt,2201.8643pt) -- (3185.9413pt,2205.8643pt) -- (3189.9413pt,2201.8643pt) -- cycle;
\draw[pstyle16] (1260.5873pt,2201.8643pt) -- (3191.9413pt,2201.8643pt);
\node at (2148.2472pt,2177.0952pt)[below right,color=black]{\textbf{45}};
\node at (2172.0694pt,2169.5986pt)[below right,color=black]{start\_run(params)};
\node at (2197.5936pt,2184.7314pt)[below right,color=black]{(if};
\node at (2214.3936pt,2184.7314pt)[below right,color=black]{ };
\node at (2219.1936pt,2184.7314pt)[below right,color=black]{enabled)};
\draw[pstyle18] (1220.5873pt,2213.8643pt) -- (1301.5873pt,2213.8643pt) -- (1301.5873pt,2221.1367pt) -- (1291.5873pt,2231.1367pt) -- (1220.5873pt,2231.1367pt) -- (1220.5873pt,2213.8643pt);
\draw[pstyle19] (1220.5873pt,2213.8643pt) rectangle (3615.8682pt,2729.4844pt);
\node at (1235.5873pt,2214.8643pt)[below right,color=black]{\textbf{loop}};
\node at (1316.5873pt,2215.8643pt)[below right,color=black]{\textbf{[for each action]}};
\draw[pstyle10] (1701.2042pt,2273.4023pt) -- (1711.2042pt,2277.4023pt) -- (1701.2042pt,2281.4023pt) -- (1705.2042pt,2277.4023pt) -- cycle;
\draw[pstyle16] (1260.5873pt,2277.4023pt) -- (1707.2042pt,2277.4023pt);
\node at (1392.6206pt,2252.6333pt)[below right,color=black]{\textbf{46}};
\node at (1416.4428pt,2245.1367pt)[below right,color=black]{execute\_action(name,};
\node at (1467.5351pt,2260.2695pt)[below right,color=black]{params)};
\draw[pstyle10] (2759.4047pt,2332.8008pt) -- (2769.4047pt,2336.8008pt) -- (2759.4047pt,2340.8008pt) -- (2763.4047pt,2336.8008pt) -- cycle;
\draw[pstyle16] (1723.2042pt,2336.8008pt) -- (2765.4047pt,2336.8008pt);
\node at (2170.5437pt,2304.4653pt)[below right,color=black]{\textbf{47}};
\node at (2242.8822pt,2289.4023pt)[below right,color=black]{GET};
\node at (2194.366pt,2304.5352pt)[below right,color=black]{/tif/\{geoprocess\}};
\node at (2206.9988pt,2319.668pt)[below right,color=black]{query};
\node at (2250.1988pt,2319.668pt)[below right,color=black]{ };
\node at (2254.9988pt,2319.668pt)[below right,color=black]{params};
\draw[pstyle10] (2988.3823pt,2377.0664pt) -- (2998.3823pt,2381.0664pt) -- (2988.3823pt,2385.0664pt) -- (2992.3823pt,2381.0664pt) -- cycle;
\draw[pstyle16] (2781.4047pt,2381.0664pt) -- (2994.3823pt,2381.0664pt);
\node at (2813.2887pt,2356.2974pt)[below right,color=black]{\textbf{48}};
\node at (2837.1109pt,2348.8008pt)[below right,color=black]{run};
\node at (2863.5109pt,2348.8008pt)[below right,color=black]{ };
\node at (2868.3109pt,2348.8008pt)[below right,color=black]{Earth};
\node at (2910.7649pt,2348.8008pt)[below right,color=black]{ };
\node at (2915.5649pt,2348.8008pt)[below right,color=black]{Engine};
\node at (2866.3788pt,2363.9336pt)[below right,color=black]{operation};
\draw[pstyle10] (2792.4047pt,2406.3389pt) -- (2782.4047pt,2410.3389pt) -- (2792.4047pt,2414.3389pt) -- (2788.4047pt,2410.3389pt) -- cycle;
\draw[pstyle20] (2786.4047pt,2410.3389pt) -- (2999.3823pt,2410.3389pt);
\node at (2843.9824pt,2393.0664pt)[below right,color=black]{\textbf{49}};
\node at (2867.8046pt,2393.1362pt)[below right,color=black]{tile};
\node at (2891.8046pt,2393.1362pt)[below right,color=black]{ };
\node at (2896.6046pt,2393.1362pt)[below right,color=black]{URLs};
\draw[pstyle10] (1734.2042pt,2435.6113pt) -- (1724.2042pt,2439.6113pt) -- (1734.2042pt,2443.6113pt) -- (1730.2042pt,2439.6113pt) -- cycle;
\draw[pstyle20] (1728.2042pt,2439.6113pt) -- (2770.4047pt,2439.6113pt);
\node at (2170.1358pt,2422.3389pt)[below right,color=black]{\textbf{50}};
\node at (2193.9581pt,2422.4087pt)[below right,color=black]{JSON};
\node at (2233.1689pt,2422.4087pt)[below right,color=black]{ };
\node at (2237.9689pt,2422.4087pt)[below right,color=black]{output\_urls};
\draw[pstyle10] (1271.5873pt,2464.8838pt) -- (1261.5873pt,2468.8838pt) -- (1271.5873pt,2472.8838pt) -- (1267.5873pt,2468.8838pt) -- cycle;
\draw[pstyle20] (1265.5873pt,2468.8838pt) -- (1712.2042pt,2468.8838pt);
\node at (1431.7325pt,2451.6113pt)[below right,color=black]{\textbf{51}};
\node at (1455.5548pt,2451.6812pt)[below right,color=black]{output\_urls};
\draw[pstyle10] (3510.557pt,2524.2822pt) -- (3520.557pt,2528.2822pt) -- (3510.557pt,2532.2822pt) -- (3514.557pt,2528.2822pt) -- cycle;
\draw[pstyle16] (1260.5873pt,2528.2822pt) -- (3516.557pt,2528.2822pt);
\node at (2316.1136pt,2495.9468pt)[below right,color=black]{\textbf{52}};
\node at (2339.9358pt,2480.8838pt)[below right,color=black]{download};
\node at (2413.758pt,2480.8838pt)[below right,color=black]{ };
\node at (2418.558pt,2480.8838pt)[below right,color=black]{tiles};
\node at (2449.758pt,2480.8838pt)[below right,color=black]{ };
\node at (2454.558pt,2480.8838pt)[below right,color=black]{+};
\node at (2379.4833pt,2496.0166pt)[below right,color=black]{merge};
\node at (2374.6833pt,2511.1494pt)[below right,color=black]{(GDAL)};
\draw[pstyle10] (3185.9413pt,2583.6807pt) -- (3195.9413pt,2587.6807pt) -- (3185.9413pt,2591.6807pt) -- (3189.9413pt,2587.6807pt) -- cycle;
\draw[pstyle16] (1260.5873pt,2587.6807pt) -- (3191.9413pt,2587.6807pt);
\node at (2131.7448pt,2555.3452pt)[below right,color=black]{\textbf{53}};
\node at (2155.5671pt,2540.2822pt)[below right,color=black]{insert\_artifact(merged};
\node at (2226.1754pt,2555.415pt)[below right,color=black]{file)};
\node at (2197.5936pt,2570.5479pt)[below right,color=black]{(if};
\node at (2214.3936pt,2570.5479pt)[below right,color=black]{ };
\node at (2219.1936pt,2570.5479pt)[below right,color=black]{enabled)};
\draw[pstyle18] (1239.5873pt,2599.6807pt) -- (1312.8873pt,2599.6807pt) -- (1312.8873pt,2606.9531pt) -- (1302.8873pt,2616.9531pt) -- (1239.5873pt,2616.9531pt) -- (1239.5873pt,2599.6807pt);
\draw[pstyle19] (1239.5873pt,2599.6807pt) rectangle (3366.7375pt,2715.4844pt);
\node at (1254.5873pt,2600.6807pt)[below right,color=black]{\textbf{opt}};
\node at (1327.8873pt,2601.6807pt)[below right,color=black]{\textbf{[POSTGIS\_ENABLED]}};
\draw[pstyle10] (3333.7375pt,2659.2188pt) -- (3343.7375pt,2663.2188pt) -- (3333.7375pt,2667.2188pt) -- (3337.7375pt,2663.2188pt) -- cycle;
\draw[pstyle16] (1260.5873pt,2663.2188pt) -- (3339.7375pt,2663.2188pt);
\node at (2238.7263pt,2638.4497pt)[below right,color=black]{\textbf{54}};
\node at (2262.5485pt,2630.9531pt)[below right,color=black]{raster2pgsql};
\node at (2357.9985pt,2630.9531pt)[below right,color=black]{ };
\node at (2362.7985pt,2630.9531pt)[below right,color=black]{|};
\node at (2299.4735pt,2646.0859pt)[below right,color=black]{psql};
\draw[pstyle10] (3185.9413pt,2703.4844pt) -- (3195.9413pt,2707.4844pt) -- (3185.9413pt,2711.4844pt) -- (3189.9413pt,2707.4844pt) -- cycle;
\draw[pstyle16] (1260.5873pt,2707.4844pt) -- (3191.9413pt,2707.4844pt);
\node at (2138.5156pt,2682.7153pt)[below right,color=black]{\textbf{55}};
\node at (2162.3378pt,2675.2188pt)[below right,color=black]{insert\_artifact(table)};
\node at (2197.5936pt,2690.3516pt)[below right,color=black]{(if};
\node at (2214.3936pt,2690.3516pt)[below right,color=black]{ };
\node at (2219.1936pt,2690.3516pt)[below right,color=black]{enabled)};
\draw[pstyle10] (3185.9413pt,2775.75pt) -- (3195.9413pt,2779.75pt) -- (3185.9413pt,2783.75pt) -- (3189.9413pt,2779.75pt) -- cycle;
\draw[pstyle16] (1260.5873pt,2779.75pt) -- (3191.9413pt,2779.75pt);
\node at (2150.6175pt,2754.981pt)[below right,color=black]{\textbf{56}};
\node at (2174.4397pt,2747.4844pt)[below right,color=black]{finish\_run(status)};
\node at (2197.5936pt,2762.6172pt)[below right,color=black]{(if};
\node at (2214.3936pt,2762.6172pt)[below right,color=black]{ };
\node at (2219.1936pt,2762.6172pt)[below right,color=black]{enabled)};
\draw[pstyle16] (479.7638pt,2824.0156pt) -- (489.7638pt,2820.0156pt);
\draw[pstyle16] (479.7638pt,2824.0156pt) -- (489.7638pt,2828.0156pt);
\draw[pstyle16] (478.7638pt,2824.0156pt) -- (1249.5873pt,2824.0156pt);
\node at (810.7278pt,2799.2466pt)[below right,color=black]{\textbf{57}};
\node at (834.55pt,2791.75pt)[below right,color=black]{geoprocess};
\node at (841.4917pt,2806.8828pt)[below right,color=black]{summary};
\draw[pstyle17] (483.7638pt,2837.0156pt) -- (483.7638pt,2862.0156pt) -- (741.7638pt,2862.0156pt) -- (741.7638pt,2847.0156pt) -- (731.7638pt,2837.0156pt) -- (483.7638pt,2837.0156pt);
\draw[pstyle17] (731.7638pt,2837.0156pt) -- (731.7638pt,2847.0156pt) -- (741.7638pt,2847.0156pt) -- (731.7638pt,2837.0156pt);
\node at (489.7638pt,2842.0156pt)[below right,color=black]{msg\_to\_interpreter = summary};
\draw[pstyle17] (483.7638pt,2903.0713pt) -- (483.7638pt,2928.0713pt) -- (711.7638pt,2928.0713pt) -- (711.7638pt,2913.0713pt) -- (701.7638pt,2903.0713pt) -- (483.7638pt,2903.0713pt);
\draw[pstyle17] (701.7638pt,2903.0713pt) -- (701.7638pt,2913.0713pt) -- (711.7638pt,2913.0713pt) -- (701.7638pt,2903.0713pt);
\node at (489.7638pt,2908.0713pt)[below right,color=black]{msg\_to\_interpreter = None};
\draw[pstyle10] (1470.6748pt,3009.7354pt) -- (1480.6748pt,3013.7354pt) -- (1470.6748pt,3017.7354pt) -- (1474.6748pt,3013.7354pt) -- cycle;
\draw[pstyle16] (478.7638pt,3013.7354pt) -- (1476.6748pt,3013.7354pt);
\node at (894.0653pt,2973.8335pt)[below right,color=black]{\textbf{58}};
\node at (939.3637pt,2951.2041pt)[below right,color=black]{main(chatbot,};
\node at (962.7363pt,2966.3369pt)[below right,color=black]{chat\_io,};
\node at (917.8875pt,2981.4697pt)[below right,color=black]{msg\_to\_interpreter,};
\node at (942.0304pt,2996.6025pt)[below right,color=black]{original};
\node at (1001.2304pt,2996.6025pt)[below right,color=black]{ };
\node at (1006.0304pt,2996.6025pt)[below right,color=black]{msg)};
\draw[pstyle18] (1471.6748pt,3025.7354pt) -- (1544.9748pt,3025.7354pt) -- (1544.9748pt,3033.0078pt) -- (1534.9748pt,3043.0078pt) -- (1471.6748pt,3043.0078pt) -- (1471.6748pt,3025.7354pt);
\draw[pstyle19] (1471.6748pt,3025.7354pt) rectangle (2360.507pt,3170.0977pt);
\node at (1486.6748pt,3026.7354pt)[below right,color=black]{\textbf{opt}};
\node at (1559.9748pt,3027.7354pt)[below right,color=black]{\textbf{[geoprocess summary present]}};
\draw[pstyle10] (1944.5571pt,3070.2803pt) -- (1954.5571pt,3074.2803pt) -- (1944.5571pt,3078.2803pt) -- (1948.5571pt,3074.2803pt) -- cycle;
\draw[pstyle16] (1492.6748pt,3074.2803pt) -- (1950.5571pt,3074.2803pt);
\node at (1586.0118pt,3057.0078pt)[below right,color=black]{\textbf{59}};
\node at (1609.834pt,3057.0776pt)[below right,color=black]{get\_metadata/get\_documentation};
\draw[pstyle10] (1503.6748pt,3099.5527pt) -- (1493.6748pt,3103.5527pt) -- (1503.6748pt,3107.5527pt) -- (1499.6748pt,3103.5527pt) -- cycle;
\draw[pstyle20] (1497.6748pt,3103.5527pt) -- (1955.5571pt,3103.5527pt);
\node at (1657.4963pt,3086.2803pt)[below right,color=black]{\textbf{60}};
\node at (1681.3186pt,3086.3501pt)[below right,color=black]{metadata/docs};
\draw[pstyle10] (2202.8876pt,3128.8252pt) -- (2212.8876pt,3132.8252pt) -- (2202.8876pt,3136.8252pt) -- (2206.8876pt,3132.8252pt) -- cycle;
\draw[pstyle16] (1492.6748pt,3132.8252pt) -- (2208.8876pt,3132.8252pt);
\node at (1715.1771pt,3115.5527pt)[below right,color=black]{\textbf{61}};
\node at (1738.9993pt,3115.6226pt)[below right,color=black]{get\_metadata/get\_documentation};
\draw[pstyle10] (1503.6748pt,3158.0977pt) -- (1493.6748pt,3162.0977pt) -- (1503.6748pt,3166.0977pt) -- (1499.6748pt,3162.0977pt) -- cycle;
\draw[pstyle20] (1497.6748pt,3162.0977pt) -- (2213.8876pt,3162.0977pt);
\node at (1786.6616pt,3144.8252pt)[below right,color=black]{\textbf{62}};
\node at (1810.4838pt,3144.895pt)[below right,color=black]{metadata/docs};
\draw[pstyle10] (727.9268pt,3216.3633pt) -- (717.9268pt,3220.3633pt) -- (727.9268pt,3224.3633pt) -- (723.9268pt,3220.3633pt) -- cycle;
\draw[pstyle16] (721.9268pt,3220.3633pt) -- (1481.6748pt,3220.3633pt);
\node at (1024.2732pt,3195.5942pt)[below right,color=black]{\textbf{63}};
\node at (1055.2573pt,3188.0977pt)[below right,color=black]{clone()};
\node at (1107.6937pt,3188.0977pt)[below right,color=black]{ };
\node at (1112.4937pt,3188.0977pt)[below right,color=black]{+};
\node at (1124.9664pt,3188.0977pt)[below right,color=black]{ };
\node at (1129.7664pt,3188.0977pt)[below right,color=black]{build};
\node at (1048.0955pt,3203.2305pt)[below right,color=black]{response};
\node at (1114.724pt,3203.2305pt)[below right,color=black]{ };
\node at (1119.524pt,3203.2305pt)[below right,color=black]{prompt};
\draw[pstyle10] (2476.1026pt,3245.6357pt) -- (2486.1026pt,3249.6357pt) -- (2476.1026pt,3253.6357pt) -- (2480.1026pt,3249.6357pt) -- cycle;
\draw[pstyle16] (716.9268pt,3249.6357pt) -- (2482.1026pt,3249.6357pt);
\node at (1503.2199pt,3232.3633pt)[below right,color=black]{\textbf{64}};
\node at (1527.0421pt,3232.4331pt)[below right,color=black]{send\_message(prompt)};
\draw[pstyle10] (727.9268pt,3289.9014pt) -- (717.9268pt,3293.9014pt) -- (727.9268pt,3297.9014pt) -- (723.9268pt,3293.9014pt) -- cycle;
\draw[pstyle20] (721.9268pt,3293.9014pt) -- (2487.1026pt,3293.9014pt);
\node at (1525.5888pt,3269.1323pt)[below right,color=black]{\textbf{65}};
\node at (1549.411pt,3261.6357pt)[below right,color=black]{natural};
\node at (1604.7897pt,3261.6357pt)[below right,color=black]{ };
\node at (1609.5897pt,3261.6357pt)[below right,color=black]{language};
\node at (1581.1115pt,3276.7686pt)[below right,color=black]{response};
\draw[pstyle10] (727.9268pt,3319.1738pt) -- (717.9268pt,3323.1738pt) -- (727.9268pt,3327.1738pt) -- (723.9268pt,3323.1738pt) -- cycle;
\draw[pstyle16] (721.9268pt,3323.1738pt) -- (1481.6748pt,3323.1738pt);
\node at (976.4194pt,3305.9014pt)[below right,color=black]{\textbf{66}};
\node at (1000.2417pt,3305.9712pt)[below right,color=black]{mem.add\_assistant(response)};
\draw[pstyle10] (3185.9413pt,3363.4395pt) -- (3195.9413pt,3367.4395pt) -- (3185.9413pt,3371.4395pt) -- (3189.9413pt,3367.4395pt) -- cycle;
\draw[pstyle16] (716.9268pt,3367.4395pt) -- (3191.9413pt,3367.4395pt);
\node at (1841.5286pt,3342.6704pt)[below right,color=black]{\textbf{67}};
\node at (1865.3509pt,3335.1738pt)[below right,color=black]{insert\_message("assistant")};
\node at (1925.7633pt,3350.3066pt)[below right,color=black]{(if};
\node at (1942.5633pt,3350.3066pt)[below right,color=black]{ };
\node at (1947.3633pt,3350.3066pt)[below right,color=black]{enabled)};
\draw[pstyle10] (264.2735pt,3392.7119pt) -- (254.2735pt,3396.7119pt) -- (264.2735pt,3400.7119pt) -- (260.2735pt,3396.7119pt) -- cycle;
\draw[pstyle16] (258.2735pt,3396.7119pt) -- (1481.6748pt,3396.7119pt);
\node at (741.6102pt,3379.4395pt)[below right,color=black]{\textbf{68}};
\node at (765.4324pt,3379.5093pt)[below right,color=black]{print\_assistant\_msg(response)};
\draw[pstyle10] (78pt,3421.9844pt) -- (68pt,3425.9844pt) -- (78pt,3429.9844pt) -- (74pt,3425.9844pt) -- cycle;
\draw[pstyle20] (72pt,3425.9844pt) -- (242.2735pt,3425.9844pt);
\node at (81.419pt,3408.7119pt)[below right,color=black]{\textbf{69}};
\node at (105.2413pt,3408.7817pt)[below right,color=black]{response};
\node at (171.8698pt,3408.7817pt)[below right,color=black]{ };
\node at (176.6698pt,3408.7817pt)[below right,color=black]{to};
\node at (191.6545pt,3408.7817pt)[below right,color=black]{ };
\node at (196.4545pt,3408.7817pt)[below right,color=black]{user};
\end{tikzpicture}
